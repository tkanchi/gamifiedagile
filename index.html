<!DOCTYPE html>
<html data-theme="light" lang="en">
<head>
  <meta charset="utf-8" />
  <meta content="width=device-width,initial-scale=1" name="viewport" />
  <title>Scrummer ‚Äî Plan</title>

  <link href="css/style.css?v=13" rel="stylesheet" />
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet"/>

  <style>
    .planWrap{ max-width: 980px; }

    .splitHeader{
      display:flex;
      justify-content:space-between;
      align-items:flex-end;
      gap:12px;
      flex-wrap:wrap;
      margin-bottom: 10px;
    }

    .forecastCard{
      margin-top: 14px;
      border: 1px solid var(--border);
      border-radius: var(--radius);
      background:
        linear-gradient(180deg, color-mix(in oklab, var(--accent) 7%, transparent), transparent),
        var(--bg-panel);
      padding: 16px;
      box-shadow: var(--shadow-soft);
    }

    .forecastTop{
      display:flex;
      justify-content:space-between;
      align-items:flex-start;
      gap:12px;
      flex-wrap:wrap;
    }

    .forecastNumber{
      font-size: 34px;
      font-weight: 850;
      letter-spacing: -0.6px;
      line-height: 1.1;
      display:flex;
      align-items:baseline;
      gap:8px;
      flex-wrap:wrap;
    }
    .forecastNumber .unit{
      font-size: 14px;
      font-weight: 650;
      color: var(--text-muted);
      letter-spacing: 0.1px;
    }

    .metaLine{
      display:flex;
      gap:10px;
      flex-wrap:wrap;
      align-items:center;
      margin-top: 10px;
      color: var(--text-muted);
      font-weight: 500;
    }

    .deltaPill{
      padding: 6px 10px;
      border-radius: 999px;
      border: 1px solid var(--border);
      background: var(--bg-soft);
      font-weight: 750;
      font-size: 12px;
      white-space: nowrap;
    }
    .deltaPill.good{
      border-color: rgba(34,197,94,.45);
      background: color-mix(in oklab, var(--bg-soft) 65%, rgba(34,197,94,.10));
    }
    .deltaPill.bad{
      border-color: rgba(239,68,68,.55);
      background: color-mix(in oklab, var(--bg-soft) 65%, rgba(239,68,68,.12));
    }

    .warnCard{
      border-left: 4px solid rgba(239,68,68,.55);
      display:none;
      margin-top: 12px;
    }

    .formulaBlock{
      margin-top: 14px;
    }

    .helperRow{
      display:flex;
      gap:14px;
      flex-wrap:wrap;
      align-items:flex-start;
      margin-top: 10px;
    }
    .helperRow .info-banner{ flex: 1; min-width: 260px; }
  </style>
</head>

<body data-page="plan">
<div class="appShell">

  <aside class="sideNav">
    <div class="sideBrand">
      <div class="brandMark"><span>S</span></div>
      <div>
        <div class="brandName">SCRUMMER</div>
        <div class="brandTag">Gamified Scrum OS</div>
      </div>
    </div>

    <nav class="nav">
      <a class="navlink active" href="index.html">üöÄ Plan</a>
      <a class="navlink" href="coach.html">ü§ñ Coach</a>
      <a class="navlink" href="Gamerules.html">üéÆ Game Rules</a>
      <a class="navlink" href="accounts.html">üîê Account</a>
    </nav>

    <div class="xpWidget">
      <div class="xpTop">
        <div>
          <div class="lvl" id="xpLevel">Level 1</div>
          <div class="title" id="xpTitle">Rookie</div>
        </div>
        <div id="moodBadge">üêÜ Calm</div>
      </div>
      <div class="xpBar"><div class="xpFill" id="xpFill"></div></div>
      <div class="xpMeta">
        <span id="xpText">0 / 300 XP</span>
        <span id="streakText">üßä streak reset</span>
      </div>
    </div>

    <div style="margin-top:14px;">
      <div class="mutedText" style="margin-bottom:6px;">üéÆ Theme</div>
      <div class="inputWrap">
        <select class="fun-input" id="themeSelect">
          <option value="light">üå§Ô∏è Light</option>
          <option value="mint">üçÉ Mint Arcade</option>
          <option value="neon">‚ö° Neon Arena</option>
          <option value="retro">üé≤ Retro Arcade</option>
        </select>
      </div>
    </div>
  </aside>

  <main class="main">
    <div class="planWrap">

      <section class="sectionCard">
        <div class="splitHeader">
          <div>
            <h1 class="sectionTitle">üóìÔ∏è Configure Upcoming Sprint (Sprint N)</h1>
            <p class="sectionSub">Enter below data of upcoming/new sprint (Sprint N as per our logic). This data will be used to generate forecast metrics.</p>
          </div>
        </div>

        <div class="info-banner">
          <strong>Tip:</strong> Sprint length = <b>working days only</b> (exclude weekends + holidays). Leave days are already handled separately.
        </div>

	        <div style="margin-top:12px;">
	          <!-- Combined input box with inset divider (doesn't touch the outer border) -->
	          <div class="inputComboCard twoCol">
	            <!-- Section 1: Upcoming Sprint -->
	            <div class="inputSection">
	              <div class="miniHeader">
	                <div class="miniTitle">Upcoming Sprint Inputs</div>
	                <div class="miniSub">These inputs drive the forecast calculation for Sprint N.</div>
	              </div>
	              <div class="fieldGrid fieldGrid-even fieldStack">
	                <div>
	                  <div class="kvKey">Sprint length (working days only)</div>
	                  <div class="inputWrap">
	                    <input class="fun-input numSm" id="setup_sprintDays" type="number" min="0" max="999" step="1" inputmode="numeric" />
	                  </div>
	                </div>

	                <div>
	                  <div class="kvKey">Team members</div>
	                  <div class="inputWrap">
	                    <input class="fun-input numSm" id="setup_teamMembers" type="number" min="0" max="999" step="1" inputmode="numeric" />
	                  </div>
	                </div>

	                <div>
	                  <div class="kvKey">Leave days (total person-days)</div>
	                  <div class="inputWrap">
	                    <input class="fun-input numSm" id="setup_leaveDays" type="number" min="0" max="999" step="1" inputmode="numeric" />
	                  </div>
	                </div>

	                <div>
	                  <div class="kvKey">Committed story points</div>
	                  <div class="inputWrap">
	                    <input class="fun-input numSm" id="setup_committedSP" type="number" min="0" max="999" step="1" inputmode="numeric" />
	                  </div>
	                </div>
	              </div>
	            </div>

	            <div class="verticalDivider" aria-hidden="true"></div>

	            <!-- Section 2: Past 3 sprints velocities -->
	            <div class="inputSection">
	              <div class="miniHeader">
	                <div class="miniTitle">Last 3 sprint velocities (completed SP)</div>
	                <div class="miniSub">Used for Velocity forecast + volatility confidence.</div>
	              </div>
	              <div class="velocityRow velStack" style="margin-top:10px;">
	                <div class="velItem">
	                  <div class="velLabel">Sprint N-1</div>
	                  <div class="inputWrap">
	                    <input class="fun-input numSm" id="setup_v1" type="number" min="0" max="999" step="1" inputmode="numeric" />
	                  </div>
	                </div>
	                <div class="velItem">
	                  <div class="velLabel">Sprint N-2</div>
	                  <div class="inputWrap">
	                    <input class="fun-input numSm" id="setup_v2" type="number" min="0" max="999" step="1" inputmode="numeric" />
	                  </div>
	                </div>
	                <div class="velItem">
	                  <div class="velLabel">Sprint N-3</div>
	                  <div class="inputWrap">
	                    <input class="fun-input numSm" id="setup_v3" type="number" min="0" max="999" step="1" inputmode="numeric" />
	                  </div>
	                </div>
	              </div>
	            </div>
	          </div>

          <!-- Presets -->
          <div style="margin-top:14px;">
            <div class="kvKey" style="margin-bottom:6px;">Quick presets</div>
            <div class="mutedText" style="margin-top:-2px;">Sets team + days + leaves + commitment + sample velocities (edit anytime).</div>
            <div class="btnRow" style="margin-top:10px;">
              <button class="btnGhost" id="setup_presetExcellent" type="button">üü¢ Excellent</button>
              <button class="btnGhost" id="setup_presetNormal" type="button">üü° Normal</button>
              <button class="btnGhost" id="setup_presetRisky" type="button">üî¥ Risky</button>
            </div>
          </div>

          <!-- Save button under presets -->
          <div style="margin-top:14px;">
            <div class="btnRow btnRow-right">
              <button class="btnGhost" id="setup_resetBtn" type="button">Reset</button>
              <button class="btnStage btnStage-next" id="setup_saveBtn" type="button">Save</button>
            </div>
            <div class="mutedText" id="setup_saveStatus" style="margin-top:8px;">Not saved yet.</div>

            <div class="coachNote" role="note" style="margin-top:10px;">
              <span class="coachNoteIcon">‚ÑπÔ∏è</span>
              <span>This sprint data will be used in the Coach Tab to generate insights, health indicators, and next recommended actions.</span>
            </div>
          </div>

          <div class="info-banner" id="setup_toast" style="display:none; margin-top:14px; border-left:4px solid color-mix(in oklab, var(--accent) 55%, transparent);">
            ‚Äî
          </div>

          <!-- ================= FORECAST ================= -->
          <div class="forecastCard" id="forecastCard">
            <div class="forecastTop">
              <div>
                <div class="kvKey">üìä Forecast Summary</div>
                <div class="mutedText" id="forecast_setupSummary" style="margin-top:6px;">‚Äî</div>
              </div>

              <div class="rightPills">
                <span class="badge" id="confidenceBadge">Confidence: ‚Äî</span>
                <span class="deltaPill" id="overcommitPill" style="display:none;">‚Äî</span>
              </div>
            </div>

            <!-- Result tiles (data first) -->
            <div class="forecastGrid">

              <div class="forecastTile">
                <div class="tileLabel">Expected Sprint Capacity</div>
                <div class="forecastNumber neonFx" style="margin-top:8px;">
                  <span id="forecast_value" class="forecastValue">‚Äî</span>
                  <span class="unit">SP</span>
                </div>
                <div class="tileSub" id="forecast_detailLine" style="margin-top:8px;">‚Äî</div>
              </div>
              
              
              <div class="forecastTile">
                <div class="tileLabel">Avg Velocity</div>
                <div class="forecastNumber neonFx" style="margin-top:8px;">
                  <span id="avgVelocityMirror">‚Äî</span> 
                  <span class="unit">SP</span>
                </div>
                <div class="tileSub">Average of Sprint N-1, N-2, N-3.</div>
             </div>

              <div class="forecastTile">
                <div class="tileLabel">Committed</div>
                <div class="forecastNumber neonFx" style="margin-top:8px;">
                <span id="committedMirror">‚Äî</span> <span class="unit">SP</span></div>
                <div class="tileSub">From your Sprint N input above.</div>
              </div>

              <div class="forecastTile">
                <div class="tileLabel">Gap</div>
                <div class="deltaRow">
                  <span id="forecast_delta" class="deltaPill" style="display:none;">‚Äî</span>
                  <span id="forecast_overcommit" class="deltaPill" style="display:none;">‚Äî</span>
                </div>
                <div class="tileSub">Shows buffer vs overcommit.</div>
              </div>

            </div>

            <!-- Calculations (kept outside tiles like "What is Over-commit Ratio?") -->
            <details class="calcDetails" style="margin-top:12px;">
              <summary>View calculations</summary>
              <div class="calcBody">
                <div id="forecast_formulaActual">‚Äî</div>
                <div class="mutedText" id="capacity_liveValues" style="margin-top:10px;">‚Äî</div>
              </div>
            </details>

            <!-- Forecast settings (kept, but visually secondary) -->
            <div class="calcWrap">
              <div class="calcHead">
                <div class="kvKey">Forecast Mode</div>
                <div class="inputWrap" style="min-width:260px;">
                  <select class="fun-input" id="forecast_forecastMode">
                    <option value="velocity">üîµ Velocity-Based (Avg of last 3)</option>
                    <option selected value="capacity">üü¢ Capacity-Based (Focus + Leaves Weight)</option>
                  </select>
                </div>
              </div>

              <div class="info-banner" id="forecast_formulaVelocity" style="display:none; margin-top:12px;">
                <div class="kvKey">üìò Velocity Formula</div>
                <div class="mutedText" style="margin-top:6px;">(Sprint N-1 + Sprint N-2 + Sprint N-3) / 3</div>
              </div>

            <!-- Velocity Mode -->
            <div class="info-banner" id="forecast_velocityBox" style="margin-top:14px; display:none;">
              <div class="kvKey">üîµ Velocity-Based</div>
              <div class="mutedText" style="margin-top:6px;">Formula: (N-1 + N-2 + N-3) / 3</div>

              <div class="toggleRow" style="margin-top:10px;">
                <input id="forecast_velOverride" type="checkbox" />
                <label for="forecast_velOverride">Override velocities (otherwise uses setup)</label>
              </div>

              <div class="velocityRow" style="margin-top:10px;">
                <div class="velItem">
                  <div class="velLabel">Sprint N-1</div>
                  <div class="inputWrap">
                    <input class="fun-input numSm" id="forecast_velN1" type="number" min="0" max="999" step="1" inputmode="numeric" disabled />
                  </div>
                </div>
                <div class="velItem">
                  <div class="velLabel">Sprint N-2</div>
                  <div class="inputWrap">
                    <input class="fun-input numSm" id="forecast_velN2" type="number" min="0" max="999" step="1" inputmode="numeric" disabled />
                  </div>
                </div>
                <div class="velItem">
                  <div class="velLabel">Sprint N-3</div>
                  <div class="inputWrap">
                    <input class="fun-input numSm" id="forecast_velN3" type="number" min="0" max="999" step="1" inputmode="numeric" disabled />
                  </div>
                </div>
              </div>
            </div>

            <!-- Capacity Mode -->
            <div class="info-banner" id="forecast_capacityBox" style="margin-top:14px;">
              <div class="kvKey">üü¢ Capacity-Based</div>
              <div class="mutedText" style="margin-top:6px;">
                Uses your sprint days + team + leaves to compute <b>Effective Team Days</b>, then multiplies by <b>SP per Team Day</b>.
              </div>

              <div class="fieldGrid fieldGrid-even" style="margin-top:10px;">
                <div>
                  <div class="velLabel">Focus factor (0.1‚Äì1.0)</div>
                  <div class="inputWrap">
                    <input class="fun-input numSm" id="forecast_focusFactor" type="number" min="0.1" max="1" step="0.05" inputmode="decimal" value="0.60" />
                  </div>
                </div>

                <div>
                  <div class="velLabel">Leaves weight (0.5‚Äì1.5)</div>
                  <div class="inputWrap">
                    <input class="fun-input numSm" id="forecast_leaveWeight" type="number" min="0.5" max="1.5" step="0.1" inputmode="decimal" value="1.0" />
                  </div>
                </div>

                <div>
                  <div class="velLabel">SP per Team Day</div>
                  <div class="inputWrap">
                    <input class="fun-input numSm" id="forecast_spPerDay" type="number" min="0" max="999" step="0.1" inputmode="decimal" value="1.0" />
                  </div>
                </div>
              </div>

              <details class="calcDetails" style="margin-top:12px;">
                <summary>Reference formulas</summary>
                <div class="calcBody">
                  <div><b>1) Ideal Capacity (Days per person)</b></div>
                  <div>Ideal = Sprint Days √ó Focus Factor</div>

                  <div style="margin-top:8px;"><b>2) Total Ideal Capacity (Days)</b></div>
                  <div>Total Ideal Days = Team Count √ó Ideal</div>

                  <div style="margin-top:8px;"><b>3) Total Actual Capacity (Days)</b></div>
                  <div>Total Actual Days = Total Ideal Days ‚àí (Leaves √ó Weight)</div>

                  <div style="margin-top:8px;"><b>4) Total Actual Capacity (SP)</b></div>
                  <div>Forecast SP = max(0, Total Actual Days) √ó SP per Team Day</div>
                </div>
              </details>
            </div>

            <details class="calcDetails" style="margin-top:12px;">
              <summary>What is Over-commit Ratio?</summary>
              <div class="calcBody">
                <b>Over-commit Ratio = Committed SP √∑ Forecast SP</b><br/>
                If ratio &gt; 1 ‚Üí you're committing more than forecast (risk). If &lt; 1 ‚Üí buffer.
              </div>
            </details>

            <div class="info-banner warnCard" id="forecast_warnBox">
              <div class="kvKey">‚ö† Fix inputs</div>
              <div id="forecast_warnText" class="mutedText" style="margin-top:6px;"></div>
            </div>

            <div class="bottomCTA" style="margin-top:18px;">
              <div>
                <div class="miniTitle">üöÄ Ready for Coach Insights?</div>
                <div class="miniSub">Open Coach to see insights, health indicators, and next recommended actions.</div>
              </div>
	            <a class="btnStage btnStage-next" href="coach.html">Go to Coach</a>
            </div>
            </div>
          </div>
          <!-- /forecast -->
        </div>
      </section>

    </div>
  </main>
</div>

<script src="js/theme.js"></script>
<script src="js/xp.js"></script>
<script src="js/plan.js"></script>
</body>
</html>
