<!DOCTYPE html>
<html data-theme="light" lang="en">
<head>
  <meta charset="utf-8" />
  <meta content="width=device-width,initial-scale=1" name="viewport" />
  <title>Scrummer â€” Plan</title>

  <link href="css/style.css?v=4" rel="stylesheet" />
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet"/>

  <style>
    /* ---------- STEP FLOW (Configure â†’ Forecast) ---------- */
    .planStepper{
      display:flex;
      align-items:center;
      gap:16px;
      margin:10px 0 20px;
    }
    .step{
      display:flex;
      align-items:center;
      gap:10px;
      cursor:pointer;
      opacity:.6;
      transition:all .2s ease;
      user-select:none;
    }
    .step.active{ opacity:1; }
    .stepDot{
      width:30px;height:30px;border-radius:50%;
      background:var(--bg-soft);
      border:1px solid var(--border);
      display:flex;align-items:center;justify-content:center;
      font-weight:700;
    }
    .step.active .stepDot{
      background: color-mix(in oklab, var(--accent) 92%, white);
      color:#fff;
      border-color: color-mix(in oklab, var(--accent) 55%, transparent);
      box-shadow: 0 6px 18px color-mix(in oklab, var(--accent) 30%, transparent);
    }
    .stepLabel{ font-weight:650; }
    .stepConnector{
      flex:1;height:2px;background:var(--border);opacity:.45;
    }
    .tabPanel.hidden{ display:none; }

    /* Premium tint for forecast panel */
    #panel-forecast .sectionCard{
      background:
        linear-gradient(180deg, color-mix(in oklab, var(--accent) 7%, transparent), transparent);
    }

    /* Forecast header row */
    .resultsHeader{
      display:flex;
      justify-content:space-between;
      align-items:flex-start;
      gap:12px;
      flex-wrap:wrap;
    }
  </style>
</head>

<body data-page="plan">
<div class="appShell">

  <aside class="sideNav">
    <div class="sideBrand">
      <div class="brandMark"><span>S</span></div>
      <div>
        <div class="brandName">SCRUMMER</div>
        <div class="brandTag">Gamified Scrum OS</div>
      </div>
    </div>

    <nav class="nav">
      <a class="navlink active" href="index.html">ğŸš€ Plan</a>
      <a class="navlink" href="coach.html">ğŸ¤– Coach</a>
      <a class="navlink" href="Gamerules.html">ğŸ® Game Rules</a>
      <a class="navlink" href="accounts.html">ğŸ” Account</a>
    </nav>

    <div class="xpWidget">
      <div class="xpTop">
        <div>
          <div class="lvl" id="xpLevel">Level 1</div>
          <div class="title" id="xpTitle">Rookie</div>
        </div>
        <div id="moodBadge">ğŸ† Calm</div>
      </div>
      <div class="xpBar"><div class="xpFill" id="xpFill"></div></div>
      <div class="xpMeta">
        <span id="xpText">0 / 300 XP</span>
        <span id="streakText">ğŸ§Š streak reset</span>
      </div>
    </div>

    <!-- Theme dropdown -->
    <div style="margin-top:14px;">
      <div class="mutedText" style="margin-bottom:6px;">ğŸ® Theme</div>
      <select class="fun-input" id="themeSelect">
        <option value="light">ğŸŒ¤ï¸ Light</option>
        <option value="neon">âš¡ Neon Arena</option>
        <option value="cyber">ğŸ§  Cyber Mint</option>
        <option value="retro">ğŸ² Retro Arcade</option>
      </select>
    </div>
  </aside>

  <main class="main">

    <!-- Stepper -->
    <div class="planStepper">
      <div class="step active" data-tab="setup" role="button" tabindex="0">
        <div class="stepDot">1</div>
        <div class="stepLabel">Configure</div>
      </div>

      <div class="stepConnector"></div>

      <div class="step" data-tab="forecast" role="button" tabindex="0">
        <div class="stepDot">2</div>
        <div class="stepLabel">Forecast</div>
      </div>
    </div>

    <!-- ================= SETUP ================= -->
    <section class="tabPanel" id="panel-setup">
      <div class="sectionCard">
        <h1 class="sectionTitle">Launchpad</h1>
        <p class="sectionSub">Enter sprint basics once. Forecast + Coach will reuse them.</p>

        <div class="info-banner">
          <strong>Tip:</strong> Accurate setup = better signals + fewer surprises.
        </div>

        <div style="margin-top:10px; max-width:860px;">
          <div class="fieldGrid">

            <div>
              <div class="kvKey" style="margin-bottom:6px;">Sprint length (working days)</div>
              <input class="fun-input numSm" id="setup_sprintDays" min="1" step="1" placeholder="10" type="number" />
            </div>

            <div>
              <div class="kvKey" style="margin-bottom:6px;">Team members</div>
              <input class="fun-input numSm" id="setup_teamMembers" min="1" step="1" placeholder="7" type="number" />
            </div>

            <div>
              <div class="kvKey" style="margin-bottom:6px;">Leave days (total person-days)</div>
              <input class="fun-input numSm" id="setup_leaveDays" min="0" step="1" placeholder="0" type="number" />
            </div>

            <div>
              <div class="kvKey" style="margin-bottom:6px;">Committed story points</div>
              <input class="fun-input numSm" id="setup_committedSP" min="0" step="1" placeholder="40" type="number" />
            </div>

          </div>

          <div class="info-banner" style="margin-top:14px;">
            <div class="kvKey">Last 3 sprint velocities (completed SP)</div>
            <div class="mutedText" style="margin-top:6px;">Used for average + volatility. Keep them tight & quick.</div>

            <div class="velocityRow" style="margin-top:10px;">
              <div class="velItem">
                <div class="velLabel">Sprint N-1</div>
                <input class="fun-input numSm" id="setup_v1" min="0" step="1" placeholder="36" type="number" />
              </div>
              <div class="velItem">
                <div class="velLabel">Sprint N-2</div>
                <input class="fun-input numSm" id="setup_v2" min="0" step="1" placeholder="41" type="number" />
              </div>
              <div class="velItem">
                <div class="velLabel">Sprint N-3</div>
                <input class="fun-input numSm" id="setup_v3" min="0" step="1" placeholder="38" type="number" />
              </div>
            </div>
          </div>

          <div style="margin-top:14px;">
            <div class="kvKey" style="margin-bottom:6px;">Quick presets</div>
            <div class="btnRow" style="margin-top:8px;">
              <button class="btnGhost" id="setup_presetExcellent" type="button">ğŸŸ¢ Excellent</button>
              <button class="btnGhost" id="setup_presetNormal" type="button">ğŸŸ¡ Normal</button>
              <button class="btnGhost" id="setup_presetRisky" type="button">ğŸ”´ Risky</button>
            </div>
          </div>

          <div class="info-banner" id="setup_toast" style="display:none; margin-top:14px; border-left:4px solid color-mix(in oklab, var(--accent) 55%, transparent);">
            â€”
          </div>

          <div class="stageIndicator">Flow: Setup â†’ Forecast â†’ Coach</div>

          <div class="stageFooter">
            <div class="left">
              <span class="mutedText">Step 1 of 2</span>
            </div>
            <div class="right">
              <button class="btnStage btnStage-action" id="setup_saveBtn" type="button">Save Setup</button>
              <button class="btnStage btnStage-next" id="goToForecastBtn" type="button">Generate Forecast â†’</button>
            </div>
          </div>

          <div class="info-banner" style="margin-top:16px;">
            <div class="kvKey">Save status</div>
            <div class="mutedText" id="setup_saveStatus" style="margin-top:6px;">Not saved yet.</div>
          </div>

        </div>
      </div>
    </section>

    <!-- ================= FORECAST ================= -->
    <section class="tabPanel hidden" id="panel-forecast">
      <div class="sectionCard">

        <div class="resultsHeader">
          <div>
            <h1 class="sectionTitle">Sprint Projection</h1>
            <p class="sectionSub">Reuses your Setup inputs. Override only if needed.</p>
          </div>
          <button class="btnGhost" id="backToSetupBtn" type="button">â† Adjust Setup</button>
        </div>

        <div class="info-banner">
          <strong>Goal:</strong> Get a clean, explainable forecast in Story Points.
        </div>

        <!-- Setup Summary (no re-entry) -->
        <div class="info-banner" style="margin-top:14px;">
          <div class="kvKey">Using Setup</div>
          <div class="summaryLine" id="forecast_setupSummary">â€”</div>

          <div class="toggleRow" style="margin-top:10px;">
            <input id="forecast_allowOverride" type="checkbox" />
            <label for="forecast_allowOverride">Allow override for this forecast</label>
          </div>

          <div class="overrideGrid" id="forecast_overrideGrid" style="display:none; margin-top:12px;">
            <div>
              <div class="velLabel">Sprint days</div>
              <input class="fun-input numSm" id="override_sprintDays" min="1" step="1" type="number" />
            </div>
            <div>
              <div class="velLabel">Team members</div>
              <input class="fun-input numSm" id="override_teamMembers" min="1" step="1" type="number" />
            </div>
            <div>
              <div class="velLabel">Leave days</div>
              <input class="fun-input numSm" id="override_leaveDays" min="0" step="1" type="number" />
            </div>
            <div>
              <div class="velLabel">Committed SP</div>
              <input class="fun-input numSm" id="override_committedSP" min="0" step="1" type="number" />
            </div>
          </div>
        </div>

        <!-- MODE SELECT -->
        <div style="margin-top:16px; max-width:540px;">
          <div class="kvKey">Forecast Mode</div>
          <select class="fun-input" id="forecast_forecastMode">
            <option value="velocity">ğŸ”µ Velocity-Based (Avg of last 3)</option>
            <option selected value="capacity">ğŸŸ¢ Capacity-Based (Focus + Leaves Weight)</option>
          </select>
        </div>

        <!-- VELOCITY MODE -->
        <div class="info-banner" id="forecast_velocityBox" style="margin-top:14px; display:none;">
          <div class="kvKey">ğŸ”µ Velocity-Based Forecast</div>
          <div class="mutedText" style="margin-top:6px;">
            Average Velocity = (N-1 + N-2 + N-3) / 3
          </div>

          <div class="velocityRow" style="margin-top:10px;">
            <div class="velItem">
              <div class="velLabel">Sprint N-1</div>
              <input class="fun-input numSm" id="forecast_velN1" min="0" step="1" type="number" />
            </div>
            <div class="velItem">
              <div class="velLabel">Sprint N-2</div>
              <input class="fun-input numSm" id="forecast_velN2" min="0" step="1" type="number" />
            </div>
            <div class="velItem">
              <div class="velLabel">Sprint N-3</div>
              <input class="fun-input numSm" id="forecast_velN3" min="0" step="1" type="number" />
            </div>
          </div>

          <div class="toggleRow" style="margin-top:10px;">
            <input id="forecast_velOverride" type="checkbox" />
            <label for="forecast_velOverride">Override velocities (otherwise uses Setup)</label>
          </div>
        </div>

        <!-- CAPACITY MODE -->
        <div class="info-banner" id="forecast_capacityBox" style="margin-top:14px;">
          <div class="kvKey">ğŸŸ¢ Capacity-Based Forecast</div>

          <div class="fieldGrid" style="margin-top:10px; max-width:860px;">
            <div>
              <div class="velLabel">Focus factor (0.1â€“1.0)</div>
              <input class="fun-input numSm" id="forecast_focusFactor" min="0" max="1" step="0.05" placeholder="0.8" type="number" />
            </div>

            <div>
              <div class="velLabel">Leaves weight (0.5â€“1.5)</div>
              <input class="fun-input numSm" id="forecast_leaveWeight" min="0" max="2" step="0.1" placeholder="1.0" type="number" />
            </div>

            <div>
              <div class="velLabel">SP per day (team)</div>
              <input class="fun-input numSm" id="forecast_spPerDay" min="0" step="0.1" placeholder="4.0" type="number" />
            </div>
          </div>
        </div>

        <div class="btnRow" style="margin-top:14px;">
          <button class="btnPrimary" id="forecast_calcBtn" type="button">Calculate ğŸ“¦</button>
          <button class="btnGhost" id="forecast_resetBtn" type="button">Reset</button>
        </div>

        <!-- RESULTS -->
        <div style="margin-top:18px;">
          <div class="kvKey">Results</div>

          <div class="info-banner" id="forecast_warnBox" style="display:none; margin-bottom:12px;">
            <div class="kvKey">âš  Check Inputs</div>
            <div id="forecast_warnText" class="mutedText" style="margin-top:6px;"></div>
          </div>

          <div class="info-banner" id="forecast_resultsBox">
            <div class="kvKey" id="forecast_resultTitle">â€”</div>
            <div id="forecast_resultMain" style="margin-top:8px;">â€”</div>

            <div class="summaryGrid" id="forecast_summaryGrid" style="display:none;">
              <div class="summaryCard">
                <div class="summaryTitle">
                  <span>Team Summary</span>
                  <span class="miniTag">Totals</span>
                </div>
                <div id="forecast_teamSummary"></div>
              </div>

              <div class="summaryCard">
                <div class="summaryTitle">
                  <span>Role Summary</span>
                  <span class="miniTag">Breakdown</span>
                </div>
                <div id="forecast_roleSummary"></div>
              </div>
            </div>

            <hr style="margin:12px 0; opacity:.2;" />

            <div class="info-banner" id="forecast_formulaReference" style="margin-bottom:12px;">
              <div class="kvKey" style="margin-bottom:6px;">ğŸ“˜ Forecast Formulas (Reference)</div>
              <div><b>1) Ideal Capacity (Days per person)</b></div>
              <div>Ideal = Sprint Days Ã— Focus Factor</div>
              <div style="margin-top:8px;"><b>2) Total Ideal Capacity (Days)</b></div>
              <div>Total Ideal Days = Team Count Ã— Ideal</div>
              <div style="margin-top:8px;"><b>3) Total Actual Capacity (Days)</b></div>
              <div>Total Actual Days = Total Ideal Days âˆ’ (Leaves Ã— Weight)</div>
              <div style="margin-top:8px;"><b>4) Total Actual Capacity (SP)</b></div>
              <div>Forecast SP = max(0, Total Actual Days) Ã— SP/day</div>
            </div>

            <div class="info-banner" id="forecast_formulaActual">
              Enter values and click Calculate to see step-by-step calculation.
            </div>
          </div>
        </div>

      </div>
    </section>

  </main>
</div>

<script src="js/theme.js"></script>
<script src="js/xp.js"></script>
<script src="js/plan.js"></script>
</body>
</html>
